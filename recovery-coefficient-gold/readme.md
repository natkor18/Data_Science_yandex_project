# Постановка задачи

1. Подготовьте прототип модели машинного обучения для «Цифры». 
2. Компания разрабатывает решения для эффективной работы промышленных предприятий.
3. Модель должна предсказать коэффициент восстановления золота из золотосодержащей руды. 
4. В нашем распоряжении данные с параметрами добычи и очистки.
5. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Вам нужно:
- Подготовить данные;
- Провести исследовательский анализ данных;
- Построить и обучить модель.

## Технологический процесс
Как золото получают из руды? Изучите внимательно стадии процесса.
Когда добытая руда проходит первичную обработку, получается дроблёная смесь. Её отправляют на флотацию (обогащение) и двухэтапную очистку.

![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/da996987-e275-4257-8774-ca90af674966)


## Опишем каждую стадию: 
1. Флотация
  -  Во флотационную установку подаётся смесь золотосодержащей руды. После обогащения получается черновой концентрат и «отвальные хвосты», то есть остатки продукта с низкой концентрацией ценных металлов.
  - На стабильность этого процесса влияет непостоянное и неоптимальное физико-химическое состояние флотационной пульпы (смеси твёрдых частиц и жидкости).

2. Очистка 
  - Черновой концентрат проходит две очистки. На выходе получается финальный концентрат и новые отвальные хвосты.

## Описание данных

### Технологический процесс
- Rougher feed — исходное сырье
- Rougher additions (или reagent additions) — флотационные реагенты: Xanthate, Sulphate, Depressant
- Xanthate — ксантогенат (промотер, или активатор флотации);
- Sulphate — сульфат (на данном производстве сульфид натрия);
- Depressant — депрессант (силикат натрия).
- Rougher process (англ. «грубый процесс») — флотация
- Rougher tails — отвальные хвосты
- Float banks — флотационная установка
- Cleaner process — очистка
- Rougher Au — черновой концентрат золота
- Final Au — финальный концентрат золота

### Параметры этапов
- air amount — объём воздуха
- fluid levels — уровень жидкости
- feed size — размер гранул сырья
- feed rate — скорость подачи

## Наименование признаков

### Наименование признаков должно быть такое:
- [этап].[тип_параметра].[название_параметра]
  Пример: rougher.input.feed_ag

### Возможные значения для блока [этап]:
- rougher — флотация
- primary_cleaner — первичная очистка
- secondary_cleaner — вторичная очистка
- final — финальные характеристики

### Возможные значения для блока [тип_параметра]:
- input — параметры сырья
- output — параметры продукта
- state — параметры, характеризующие текущее состояние этапа
- calculation — расчётные характеристики

## Расчёт эффективности
- Вам нужно смоделировать процесс восстановления золота из золотосодержащей руды.

## Эффективность обогащения рассчитывается по формуле
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/4090c157-5774-483f-8794-d749a1ee57a7)

где:
- C — доля золота в концентрате после флотации/очистки;
- F — доля золота в сырье/концентрате до флотации/очистки;
- T — доля золота в отвальных хвостах после флотации/очистки.

Для прогноза коэффициента нужно найти долю золота в концентратах и хвостах. Причём важен не только финальный продукт, но и черновой концентрат.

## Метрика качества
- Для решения задачи введём новую метрику качества — sMAPE (англ. Symmetric Mean Absolute Percentage Error, «симметричное среднее абсолютное процентное отклонение»).
- Она похожа на MAE, но выражается не в абсолютных величинах, а в относительных. Почему симметричная? Она одинаково учитывает масштаб и целевого признака, и предсказания.

## Метрика sMAPE вычисляется так:
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/2f03a638-be81-48e6-b63f-8df2453ab451)


Обозначения:
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/476be424-b4ae-4126-9e96-57d5e094676a)


Значение целевого признака для объекта с порядковым номером i в выборке, на которой измеряется качество.
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/6690037f-8933-4be5-a9cc-6fb8789ef2e1)


Значение предсказания для объекта с порядковым номером i, например, в тестовой выборке.
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/9e7bb3d6-51ac-4925-b27a-9326a81856c0)


Количество объектов в выборке.
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/c6564c3c-5ddf-4720-b545-cac6957d8ead)

Суммирование по всем объектам выборки (i меняется от 1 до N).

Нужно спрогнозировать сразу две величины:
- эффективность обогащения чернового концентрата rougher.output.recovery;
- эффективность обогащения финального концентрата final.output.recovery.

Итоговая метрика складывается из двух величин:
![image](https://github.com/natkor18/Data_Science_yandex_project/assets/65555577/cd5e1d8b-45b5-48ac-bcd0-edfa62d20d06)
